# vim: ft=sh

. ~/.tq84-dotfile-sequence .profile

# This file is not read by bash,
# if ~/.bash_profile or ~/.bash_login
# exists.

if [ "$BASH" ]; then # {

  echo $(date) ".profile: \$BASH=$BASH, definining function dot_file_log()" >> ~/.dotfile-sequence.log
  dot_file_log() {
    local script_name=$1
    local text=$2
    echo $(date) $script_name: $text >> ~/.dotfile-sequence.log
  }
  export -f dot_file_log

fi # }

# { Environment variables
export TZ=Europe/Zurich
export EDITOR=gvim

if [[ -d ~/github ]]; then # {
   export github_top_root=~/github/
   export github_root=${github_top_root}github/
   dot_file_log .profile "github_top_root=$github_top_root, github_root=$github_root"
fi # }

if [ -d ${github_root}vim/runtime ]; then # { VIMRUNTIME
  export VIMRUNTIME=${github_root}vim/runtime
  dot_file_log .profile "exported VIMRUNTIME=$VIMRUNTIME"
fi # }


# }

dot_file_log .profile "\$BASH=$BASH"
if [ "$BASH" ] && [ -f ~/.bashrc ]; then # {
    dot_file_log .profile "It's a bash and ~/.bashrc exists, so sourcing it"
    . ~/.bashrc
fi # }

if [ -d "$HOME/bin" ] ; then # {
    PATH="$HOME/bin:$PATH"
fi # }

if [ -r ~/.ls_colors ]; then # {
  dot_file_log .profile "~/.ls_colors is readable, so sourcing it"
  . ~/.ls_colors
else
  dot_file_log .profile "~/.ls_colors is NOT readable"
fi # }

if [ -d /u01/app/oracle ]; then # 2018-01-31 { Oracle

  export ORACLE_BASE=/u01/app/oracle
  dot_file_log .profile "/u01/app/oracle exists, exporting ORACLE_BASE=$ORACLE_BASE"

  if [ -d $ORACLE_BASE/product/*/*1 ]; then

#    export ORACLE_HOME=($ORACLE_BASE/product/*/*1)  # Parentheses used in order to expand the stars: https://stackoverflow.com/a/104023/180275
     export ORACLE_HOME=$(ls -1d $ORACLE_BASE/product/*/*1)
     dot_file_log .profile "$ORACLE_BASE/product/12.2.0/*1 exists, exporting ORACLE_HOME=$ORACLE_HOME"

     export ORACLE_SID=ORA12
     export ORACLE_UNQNAME=ORA12              # Apparently used for $ORACLE_BASE/diag/rdbms/$ORACLE_UNQNAME/$ORACLE_SID/trace
     export PATH=$ORACLE_HOME/bin:$PATH:.
  #  export LD_LIBRARY_PATH=$ORACLE_HOME/lib:/lib:/usr/lib # ???
  #  export CLASSPATH=$ORACLE_HOME/JRE:$ORACLE_HOME/jlib:$ORACLE_HOME/rdbms/jlib # Really needed?

     if [[ -d $github_root/oracle_scriptlets/sqlpath ]]; then
      #  Apparently, ORACLE_PATH, rather than SQLPATH is needed nowadays.
      #  export SQLPATH=$github_root/oracle_scriptlets/sqlpath
         export ORACLE_PATH=${github_root}oracle_scriptlets/sqlpath
         dot_file_log .profile "$github_root/oracle_scriptlets/sqlpath exists, exporting ORACLE_PATH=$ORACLE_PATH"
     else
         dot_file_log .profile "$github_root/oracle_scriptlets/sqlpath does not exist"
     fi
  fi # }

fi # }


# best privacy
umask 077

true
